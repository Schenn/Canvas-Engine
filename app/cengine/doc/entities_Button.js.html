<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: entities/Button.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: entities/Button.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @author Steven Chennault &lt;schenn@gmail.com>
 */
/**
 * @typedef {object} LocalParams~ButtonParams
 * @property {object} background
 * @property {object} [hover]
 * @property {number} padding
 * @property {string} fillStyle
 * @property {number} x
 * @property {number} y
 */
(function (CanvasEngine) {

  var EM = CanvasEngine.EntityManager;
  var utilities = CanvasEngine.utilities;

  // Tell the EntityManager how to create a "Button"
  EM.setMake("Button",
    /**
     * @param {CanvasEngine.Entities.Entity} entity
     * @param {LocalParams~ButtonParams} params
     * @returns {CanvasEngine.Entities.Button}
     */
    function (entity, params) {

      var background;
      var hover;

      var isHovering;

      if(utilities.exists(params.background.spritesheet)){
        background = EM.create("SPRITE", $.extend({}, {fromCenter: true}, params.background));
      } else if(utilities.exists(params.background.source)){
        background = EM.create("IMAGE", $.extend({}, {fromCenter: true}, params.background.source));
      } else {
        background = EM.create("RECT", $.extend({}, {fromCenter: true}, params.background));
      }

      if(utilities.exists(params.hover)) {
        if (utilities.exists(params.hover.spritesheet)) {
          hover = EM.create("SPRITE", $.extend({}, {fromCenter: true}, params.hover));
        } else if (utilities.exists(params.hover.source)) {
          hover = EM.create("IMAGE", $.extend({}, {fromCenter: true}, params.hover.source));
        } else {
          hover = EM.create("RECT", $.extend({}, {fromCenter: true}, params.hover));
        }
      }

      /**
       * @class
       * @augments CanvasEngine.Entities.Entity
       * @memberOf CanvasEngine.Entities
       */
      var Button = $.extend(true, {}, {
        getBackground: function(){
          return background;
        },
        setBackground: function(newBg){
          background = newBg;
        }
      }, entity);

      EM.attachComponent(Button, {
          "Mouse":{
            "HoverMouse": {
              onMouseOver: function () {
                isHovering = true;
                Button.messageToComponent("Renderer", "markDirty");
              }, onMouseOut: function () {
                isHovering = false;
                Button.messageToComponent("Renderer", "markDirty");
              }
            }
          }
        }
      );

      EM.attachComponent(Button, "Text", $.extend({},
        {
          callback: function(){
            Button.messageToComponent("Renderer", "markDirty");
          }
        },
        params)
      );

      EM.attachComponent(Button, "Renderer", $.extend({}, { fromCenter: true,
        clearInfo: function(ctx){
          // Return the background's clearInfo
          return background.getFromComponent("Renderer", "ClearInfo", ctx);
        },
        draw: function(ctx){
          // Resize the background based on the height and width of the text, adjusted by the padding params.
          var text = Button.getFromComponent("Text","asObject");
          var size = {
            width : (ctx.measureText({font: text.font, text:text.text}).width)+4,
            //noinspection JSSuspiciousNameCombination
            // The measureText method only returns a width of a text element. To get a height, we use the average of the largest characters.
            height : (ctx.measureText({font: text.font, text:"MWO"}).width/3)+4
          };

          size.width += (params.padding * 2);
          size.height += (params.padding * 2);

          if(isHovering &amp;&amp; utilities.exists(hover)){
            hover.messageToComponent(
              "Renderer", "setPosition", {x: this.x}
            );

            hover.messageToComponent(
              "Renderer", "setPosition", {y: this.y}
            );

            hover.messageToComponent(
              "Renderer",
              "resize",
              size
            );

            // Draw the background
            hover.messageToComponent("Renderer", "render", ctx);
          } else {
            background.messageToComponent(
              "Renderer", "setPosition", {x: this.x}
            );

            background.messageToComponent(
              "Renderer", "setPosition", {y: this.y}
            );

            background.messageToComponent(
              "Renderer",
              "resize",
              size
            );

            // Draw the background
            background.messageToComponent("Renderer", "render", ctx);
          }


          this.resize(size);

          // Draw the text
          ctx.setDefaults(this);
          ctx.drawText($.extend({}, this, Button.getFromComponent("Text", "asObject")));
        }
      },{x: params.x, y: params.y, fillStyle: params.fillStyle}));


      return Button;
  });
})(window.CanvasEngine);</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Externals</h3><ul><li><a href="external-jQuery.html">jQuery</a></li></ul><h3>Classes</h3><ul><li><a href="Canvas.enhancedContext.html">enhancedContext</a></li><li><a href="CanvasEngine.Components.Image.html">Image</a></li><li><a href="CanvasEngine.Components.KeyPress.html">KeyPress</a></li><li><a href="CanvasEngine.Components.Mouse.html">Mouse</a></li><li><a href="CanvasEngine.Components.Movement.html">Movement</a></li><li><a href="CanvasEngine.Components.PointPlotter.html">PointPlotter</a></li><li><a href="CanvasEngine.Components.Renderer.html">Renderer</a></li><li><a href="CanvasEngine.Components.SpriteSheet.html">SpriteSheet</a></li><li><a href="CanvasEngine.Components.Text.html">Text</a></li><li><a href="CanvasEngine.Components.TileMap.html">TileMap</a></li><li><a href="CanvasEngine.Components.TileMap_TileClick.html">TileClick</a></li><li><a href="CanvasEngine.Components.Timer.html">Timer</a></li><li><a href="CanvasEngine.Entities.AnimatedSprite.html">AnimatedSprite</a></li><li><a href="CanvasEngine.Entities.Animator.html">Animator</a></li><li><a href="CanvasEngine.Entities.Button.html">Button</a></li><li><a href="CanvasEngine.Entities.Entity.html">Entity</a></li><li><a href="CanvasEngine.Entities.Image.html">Image</a></li><li><a href="CanvasEngine.Entities.Line.html">Line</a></li><li><a href="CanvasEngine.Entities.MobileSprite.html">MobileSprite</a></li><li><a href="CanvasEngine.Entities.Rect.html">Rect</a></li><li><a href="CanvasEngine.Entities.Sprite.html">Sprite</a></li><li><a href="CanvasEngine.Entities.TileMap.html">TileMap</a></li><li><a href="CanvasEngine.Resources.SpriteSheet.html">SpriteSheet</a></li><li><a href="CanvasEngine.Screen.html">Screen</a></li><li><a href="CanvasEngine-EntityManager.html">EntityManager</a></li><li><a href="CanvasEngine-EntityManager.baseEntity.html">baseEntity</a></li><li><a href="CanvasEngine-EntityTracker.html">EntityTracker</a></li><li><a href="CanvasEngine-resourceManager.html">resourceManager</a></li></ul><h3>Events</h3><ul><li><a href="keyboard.html#event:keypress">keypress</a></li></ul><h3>Namespaces</h3><ul><li><a href="Callbacks.html">Callbacks</a></li><li><a href="Canvas.html">Canvas</a></li><li><a href="CanvasEngine.html">CanvasEngine</a></li><li><a href="CanvasEngine.Components.html">Components</a></li><li><a href="CanvasEngine.Entities.html">Entities</a></li><li><a href="CanvasEngine.Properties.html">Properties</a></li><li><a href="CanvasEngine.Resources.html">Resources</a></li><li><a href="CanvasEngine%250A%250AA%2520collection%2520of%2520utility%2520functions.utilities.html">utilities</a></li><li><a href="external-jQuery.fn.html">fn</a></li><li><a href="GeneralTypes.html">GeneralTypes</a></li><li><a href="keyboard.html">keyboard</a></li><li><a href="LocalParams.html">LocalParams</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Thu Jun 02 2016 00:41:14 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
